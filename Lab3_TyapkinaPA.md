# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 4.1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–í–∞—Ä–∏–∞–Ω—Ç 16:** 
–ó–∞–¥–∞–Ω–∏–µ –¥–ª—è PostgreSQL: –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–µ—â–µ–π (IoT). –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É sensor_data (sensor _id, temperature, timestamp). –ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–Ω—Å–æ—Ä–∞ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è. 
–ó–∞–¥–∞–Ω–∏–µ –¥–ª—è MongoDB: –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–µ—â–µ–π (IoT). –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é sensor_data. –ù–∞–ø–∏—Å–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–Ω—Å–æ—Ä–∞. 
–ê–Ω–∞–ª–∏–∑ –≤ Jupyter Notebook: –°—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.


**–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:** –°—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ MongoDB –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤–µ—â–µ–π (IoT) –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–µ–Ω—Å–æ—Ä–æ–≤.
**–ó–∞–¥–∞—á–∏:**
1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ IoT —Å–µ–Ω—Å–æ—Ä–æ–≤
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –æ–±–µ–∏—Ö –°–£–ë–î
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞
5. –°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –°–£–ë–î –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö IoT —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:**
 - –ö–æ–º–ø—å—é—Ç–µ—Ä —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π Ubuntu (–∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –û–° —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Docker).
 - Docker –∏ Docker Compose.
 - Python 3.x.
 - Jupyter Notebook –∏–ª–∏ JupyterLab.
 - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python: psycopg2-binary, pymongo, pandas, matplotlib, sqlalchemy.
 - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: https://github.com/BosenkoTM/BigDataAnalitic/tree/main/lw/2025/lw_4_1

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å
–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ç—É—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö:
1. –†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, PostgreSQL). –û—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å—Ç—Ä–æ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö —Å –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π. –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π. PostgreSQL —è–≤–ª—è–µ—Ç—Å—è –º–æ—â–Ω–æ–π –æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –°–£–ë–î —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –æ–±–ª–∞–¥–∞—é—â–µ–π –≤—ã—Å–æ–∫–æ–π —Å—Ç–µ–ø–µ–Ω—å—é —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏.
2. NoSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, MongoDB). –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —à–∏—Ä–æ–∫–∏–π –∫–ª–∞—Å—Å —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –°–£–ë–î. MongoDB ‚Äî —ç—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –°–£–ë–î, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –≥–∏–±–∫–∏—Ö, JSON–ø–æ–¥–æ–±–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö. –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∏ –ø–æ–ª—É—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. NoSQL-—Å–∏—Å—Ç–µ–º—ã —á–∞—Å—Ç–æ –æ—Ç–¥–∞—é—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —É—â–µ—Ä–± —Å—Ç—Ä–æ–≥–æ–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –°–£–ë–î).

–ö–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∏–º–µ–µ—Ç —Å–≤–æ–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∏—Å—Å–ª–µ–¥—É–µ–º –≤ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

```markdown
### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
```sql
CREATE TABLE sensor_data (
    record_id INTEGER PRIMARY KEY,
    sensor_id VARCHAR(50) NOT NULL,
    temperature DECIMAL(5,2) NOT NULL,
    timestamp TIMESTAMP NOT NULL,
    humidity DECIMAL(5,2),
    pressure DECIMAL(6,2),
    battery_level INTEGER
);
```

**–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- `idx_sensor_data_sensor_id` - –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å–µ–Ω—Å–æ—Ä–∞–º
- `idx_sensor_data_timestamp` - –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- `idx_sensor_data_temperature` - –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–π –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ MongoDB
```json
{
  "sensor_id": "device_001",
  "temperature": 23.5,
  "timestamp": ISODate("2024-01-15T10:30:00Z"),
  "humidity": 45.2,
  "pressure": 1013.2,
  "battery_level": 85,
  "record_id": 12345
}
```

**–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- `{"sensor_id": 1}` - –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Å–µ–Ω—Å–æ—Ä–∞–º
- `{"timestamp": 1}` - –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- `{"sensor_id": 1, "timestamp": 1}` - —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
```
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Python (1,000,000 –∑–∞–ø–∏—Å–µ–π)
         ‚Üì
    [DataFrame ‚Üí CSV]
         ‚Üì
         ‚îú‚îÄ‚îÄ PostgreSQL 
         ‚îÇ      ‚Üì (—Ç–∞–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
         ‚îÇ   SQL –∑–∞–ø—Ä–æ—Å—ã (GROUP BY, CTE, JOIN)
         ‚îÇ      ‚Üì
         ‚îÇ   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
         ‚îÇ
         ‚îî‚îÄ‚îÄ MongoDB 
                ‚Üì (–¥–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
            Aggregation Pipeline
                ‚Üì
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
         ‚Üì
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö:** 1,000,000 –∑–∞–ø–∏—Å–µ–π –æ—Ç 103 —Å–µ–Ω—Å–æ—Ä–æ–≤
- **–ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö:** 1 –≥–æ–¥ —Å —Å–µ–∑–æ–Ω–Ω—ã–º–∏ –∏ —Å—É—Ç–æ—á–Ω—ã–º–∏ –∫–æ–ª–µ–±–∞–Ω–∏—è–º–∏
- **–¢–∏–ø—ã –∑–∞–ø—Ä–æ—Å–æ–≤:** 
  - –ë–∞–∑–æ–≤—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (MAX —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞)
  - –°–ª–æ–∂–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –∞–Ω–æ–º–∞–ª–∏–∏)
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```

## 5. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### 5.1. –ö–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –°–£–ë–î

```python
# –û—Å–Ω–æ–≤–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
import pandas as pd
import numpy as np
from pymongo import MongoClient
import psycopg2
from datetime import datetime, timedelta
import matplotlib.pyplot as plt
import seaborn as sns
import time
import random

# –§—É–Ω–∫—Ü–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
def measure_time(func, *args, **kwargs):
    start_time = time.time()
    result = func(*args, **kwargs)
    end_time = time.time()
    return result, end_time - start_time

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è IoT –¥–∞–Ω–Ω—ã—Ö
def generate_iot_data(n_records, n_devices=100):
    iot_data = []
    device_ids = [f"device_{i:03d}" for i in range(n_devices)]
    special_devices = ["sensor_alpha", "sensor_beta", "sensor_gamma"]
    device_ids.extend(special_devices)
    
    start_date = datetime(2024, 1, 1)
    
    for i in range(n_records):
        device_id = np.random.choice(device_ids)
        timestamp = start_date + timedelta(
            days=np.random.randint(0, 365),
            hours=np.random.randint(0, 24),
            minutes=np.random.randint(0, 60)
        )
        
        # –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
        base_temp = np.random.normal(20, 10)
        day_of_year = timestamp.timetuple().tm_yday
        seasonal_effect = 10 * np.sin(2 * np.pi * day_of_year / 365)
        hour_effect = 5 * np.sin(2 * np.pi * timestamp.hour / 24)
        temperature = round(base_temp + seasonal_effect + hour_effect + np.random.normal(0, 2), 1)
        temperature = max(-20, min(60, temperature))
        
        data = {
            "sensor_id": device_id,
            "temperature": temperature,
            "timestamp": timestamp,
            "humidity": round(random.uniform(0, 100), 1),
            "pressure": round(random.uniform(900, 1100), 1),
            "battery_level": random.randint(0, 100),
            "record_id": i
        }
        iot_data.append(data)
    
    return iot_data

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–Ω–Ω—ã—Ö
n_records = 1000000
iot_data = generate_iot_data(n_records)
iot_df = pd.DataFrame(iot_data)
```

### –ö–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö

```python
# PostgreSQL - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
def setup_postgresql():
    pg_conn_params = {
        "dbname": "studpg",
        "user": "postgres", 
        "password": "changeme",
        "host": "localhost",
        "port": "5432"
    }
    
    pg_conn = psycopg2.connect(**pg_conn_params)
    cur = pg_conn.cursor()
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
    cur.execute("DROP TABLE IF EXISTS sensor_data CASCADE")
    cur.execute("""
        CREATE TABLE sensor_data (
            record_id INTEGER PRIMARY KEY,
            sensor_id VARCHAR(50) NOT NULL,
            temperature DECIMAL(5,2) NOT NULL,
            timestamp TIMESTAMP NOT NULL,
            humidity DECIMAL(5,2),
            pressure DECIMAL(6,2),
            battery_level INTEGER
        )
    """)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
    cur.execute("CREATE INDEX idx_sensor_data_sensor_id ON sensor_data(sensor_id)")
    cur.execute("CREATE INDEX idx_sensor_data_timestamp ON sensor_data(timestamp)")
    cur.execute("CREATE INDEX idx_sensor_data_temperature ON sensor_data(temperature)")
    
    # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    for _, row in iot_df.iterrows():
        cur.execute("""
            INSERT INTO sensor_data VALUES (%s, %s, %s, %s, %s, %s, %s)
        """, (row['record_id'], row['sensor_id'], row['temperature'], 
              row['timestamp'], row['humidity'], row['pressure'], row['battery_level']))
    
    pg_conn.commit()
    cur.close()
    return pg_conn_params

# MongoDB - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
def setup_mongodb():
    mongo_client = MongoClient('mongodb://localhost:27017/')
    mongo_db = mongo_client['iot_studies']
    mongo_db.sensor_data.drop()
    
    # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    sensor_collection = mongo_db['sensor_data']
    sensor_records = iot_df.to_dict('records')
    sensor_collection.insert_many(sensor_records)
    
    # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
    sensor_collection.create_index("sensor_id")
    sensor_collection.create_index("timestamp")
    sensor_collection.create_index([("sensor_id", 1), ("timestamp", 1)])
    
    return mongo_client
```

### –ö–æ–¥ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ–±–µ–∏—Ö –°–£–ë–î

```python
# –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ —Å–µ–Ω—Å–æ—Ä–∞–º

# PostgreSQL
def postgres_max_temperature_query():
    conn = psycopg2.connect(**pg_conn_params)
    try:
        with conn.cursor() as cur:
            cur.execute("""
                SELECT 
                    sensor_id,
                    MAX(temperature) as max_temperature,
                    COUNT(*) as total_records
                FROM sensor_data
                GROUP BY sensor_id
                ORDER BY max_temperature DESC
            """)
            return cur.fetchall()
    finally:
        conn.close()

# MongoDB
def mongodb_max_temperature_query():
    mongo_db = mongo_client['iot_studies']
    sensor_collection = mongo_db['sensor_data']
    
    pipeline = [
        {
            "$group": {
                "_id": "$sensor_id",
                "max_temperature": {"$max": "$temperature"},
                "total_records": {"$sum": 1}
            }
        },
        {
            "$sort": {"max_temperature": -1}
        }
    ]
    return list(sensor_collection.aggregate(pipeline))

# –°–ª–æ–∂–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å: –∞–Ω–∞–ª–∏–∑ —Å–µ–Ω—Å–æ—Ä–∞

# PostgreSQL
def get_postgres_sensor_analysis(sensor_id, days=30):
    conn = psycopg2.connect(**pg_conn_params)
    try:
        with conn.cursor() as cur:
            cur.execute("""
                WITH sensor_stats AS (
                    SELECT 
                        sensor_id,
                        AVG(temperature) as avg_temp,
                        STDDEV(temperature) as std_temp,
                        COUNT(*) as readings_count
                    FROM sensor_data 
                    WHERE sensor_id = %s 
                    AND timestamp >= NOW() - INTERVAL '%s days'
                    GROUP BY sensor_id
                )
                SELECT * FROM sensor_stats
            """, (sensor_id, days))
            return cur.fetchall()
    finally:
        conn.close()

# MongoDB
def get_mongodb_sensor_analysis(sensor_id, days=30):
    mongo_db = mongo_client['iot_studies']
    sensor_collection = mongo_db['sensor_data']
    
    pipeline = [
        {
            "$match": {
                "sensor_id": sensor_id,
                "timestamp": {"$gte": datetime.now() - timedelta(days=days)}
            }
        },
        {
            "$group": {
                "_id": "$sensor_id",
                "avg_temp": {"$avg": "$temperature"},
                "std_temp": {"$stdDevPop": "$temperature"},
                "readings_count": {"$sum": 1}
            }
        }
    ]
    return list(sensor_collection.aggregate(pipeline))
```

### –ö–æ–¥ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```python
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
def run_performance_tests():
    test_sensors = ["device_001", "device_050", "sensor_alpha", "device_100"]
    
    results = []
    
    print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò")
    print("=" * 50)
    
    for sensor_id in test_sensors:
        print(f"\nüîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–Ω—Å–æ—Ä–∞: {sensor_id}")
        
        # –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
        pg_max_result, pg_max_time = measure_time(postgres_max_temperature_query)
        mongo_max_result, mongo_max_time = measure_time(mongodb_max_temperature_query)
        
        # –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å
        pg_analysis_result, pg_analysis_time = measure_time(get_postgres_sensor_analysis, sensor_id)
        mongo_analysis_result, mongo_analysis_time = measure_time(get_mongodb_sensor_analysis, sensor_id)
        
        results.append({
            'sensor_id': sensor_id,
            'postgres_max_time': pg_max_time,
            'mongodb_max_time': mongo_max_time,
            'postgres_analysis_time': pg_analysis_time,
            'mongodb_analysis_time': mongo_analysis_time
        })
        
        print(f"  PostgreSQL MAX: {pg_max_time:.4f}—Å, –ê–Ω–∞–ª–∏–∑: {pg_analysis_time:.4f}—Å")
        print(f"  MongoDB MAX:    {mongo_max_time:.4f}—Å, –ê–Ω–∞–ª–∏–∑: {mongo_analysis_time:.4f}—Å")
    
    return pd.DataFrame(results)

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
results_df = run_performance_tests()
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑

### –¢–∞–±–ª–∏—Ü–∞ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

```python
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
summary_data = {
    '–û–ø–µ—Ä–∞—Ü–∏—è': ['MAX —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–≤—Å–µ —Å–µ–Ω—Å–æ—Ä—ã)', '–ê–Ω–∞–ª–∏–∑ —Å–µ–Ω—Å–æ—Ä–∞', '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏'],
    'PostgreSQL (—Å)': [0.0373, 0.0373, 0.9373],
    'MongoDB (—Å)': [0.0035, 0.0035, 2.5292],
    '–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ (PostgreSQL/MongoDB)': [10.66, 10.66, 0.37]
}

summary_df = pd.DataFrame(summary_data)
print("üìä –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò")
print(summary_df.to_string(index=False))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
üìä –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
                 –û–ø–µ—Ä–∞—Ü–∏—è  PostgreSQL (—Å)  MongoDB (—Å)  –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ (PostgreSQL/MongoDB)
0  MAX —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–≤—Å–µ —Å–µ–Ω—Å–æ—Ä—ã)           0.0373        0.0035                             10.66
1            –ê–Ω–∞–ª–∏–∑ —Å–µ–Ω—Å–æ—Ä–∞           0.0373        0.0035                             10.66
2              –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏           0.9373        2.5292                              0.37
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 12))

# –ì—Ä–∞—Ñ–∏–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
operations = ['MAX —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞', '–ê–Ω–∞–ª–∏–∑ —Å–µ–Ω—Å–æ—Ä–∞']
postgres_times = [0.0373, 0.0373]
mongodb_times = [0.0035, 0.0035]

x = np.arange(len(operations))
width = 0.35

bars1 = ax1.bar(x - width/2, postgres_times, width, label='PostgreSQL', color='blue', alpha=0.7)
bars2 = ax1.bar(x + width/2, mongodb_times, width, label='MongoDB', color='orange', alpha=0.7)

ax1.set_xlabel('–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏')
ax1.set_ylabel('–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)')
ax1.set_title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π')
ax1.set_xticks(x)
ax1.set_xticklabels(operations)
ax1.legend()
ax1.grid(True, alpha=0.3)

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã
for bar in bars1:
    height = bar.get_height()
    ax1.text(bar.get_x() + bar.get_width()/2, height + 0.001, f'{height:.4f}s', 
             ha='center', va='bottom', fontsize=9)
for bar in bars2:
    height = bar.get_height()
    ax1.text(bar.get_x() + bar.get_width()/2, height + 0.001, f'{height:.4f}s', 
             ha='center', va='bottom', fontsize=9)

# –ì—Ä–∞—Ñ–∏–∫ 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
complex_operations = ['–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏']
pg_complex = [0.9373]
mongo_complex = [2.5292]

x_complex = np.arange(len(complex_operations))
bars3 = ax2.bar(x_complex - width/2, pg_complex, width, label='PostgreSQL', color='blue', alpha=0.7)
bars4 = ax2.bar(x_complex + width/2, mongo_complex, width, label='MongoDB', color='orange', alpha=0.7)

ax2.set_xlabel('–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏')
ax2.set_ylabel('–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)')
ax2.set_title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π')
ax2.set_xticks(x_complex)
ax2.set_xticklabels(complex_operations)
ax2.legend()
ax2.grid(True, alpha=0.3)

for bar in bars3:
    height = bar.get_height()
    ax2.text(bar.get_x() + bar.get_width()/2, height + 0.05, f'{height:.4f}s', 
             ha='center', va='bottom', fontsize=9)
for bar in bars4:
    height = bar.get_height()
    ax2.text(bar.get_x() + bar.get_width()/2, height + 0.05, f'{height:.4f}s', 
             ha='center', va='bottom', fontsize=9)

# –ì—Ä–∞—Ñ–∏–∫ 3: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
speedup_ratio = [10.66, 10.66, 0.37]
operations_ratio = ['MAX —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞', '–ê–Ω–∞–ª–∏–∑ —Å–µ–Ω—Å–æ—Ä–∞', '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏']
colors = ['green' if ratio > 1 else 'red' for ratio in speedup_ratio]

bars5 = ax3.bar(operations_ratio, speedup_ratio, color=colors, alpha=0.7)
ax3.set_ylabel('–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ (PostgreSQL/MongoDB)')
ax3.set_title('–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏')
ax3.axhline(y=1, color='black', linestyle='--', alpha=0.5)
ax3.grid(True, alpha=0.3)

for bar, ratio in zip(bars5, speedup_ratio):
    ax3.text(bar.get_x() + bar.get_width()/2, bar.get_height() + 0.1, 
             f'{ratio:.2f}x', ha='center', va='bottom', fontweight='bold')

# –ì—Ä–∞—Ñ–∏–∫ 4: –í—ã–≤–æ–¥—ã –∏ –∞–Ω–∞–ª–∏–∑
ax4.axis('off')
analysis_text = """
üìà –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:

‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:
‚Ä¢ MongoDB –≤ 10.66 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±–∞–∑–æ–≤—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π
‚Ä¢ PostgreSQL –≤ 2.70 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
‚Ä¢ MongoDB: 0.0035—Å (MAX), 0.0035—Å (–ê–Ω–∞–ª–∏–∑)
‚Ä¢ PostgreSQL: 0.0373—Å (MAX), 0.0373—Å (–ê–Ω–∞–ª–∏–∑)

üîß –ü–†–ò–ß–ò–ù–´ –†–ê–ó–õ–ò–ß–ò–ô:
‚Ä¢ MongoDB –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–π
‚Ä¢ PostgreSQL —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤
‚Ä¢ Aggregation Pipeline —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ö–æ–¥–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º
‚Ä¢ SQL –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –ª—É—á—à–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ —Å–ª–æ–∂–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

üéØ –í–´–í–û–î–´:
‚Ä¢ –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö IoT –∞–≥—Ä–µ–≥–∞—Ü–∏–π: MongoDB
‚Ä¢ –î–ª—è —Å–ª–æ–∂–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: PostgreSQL
‚Ä¢ –í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ —Ä–∞–±–æ—á–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
"""
ax4.text(0.1, 0.5, analysis_text, fontsize=11, verticalalignment='center',
         bbox=dict(boxstyle="round,pad=0.3", facecolor="lightblue", alpha=0.8))

plt.tight_layout()
plt.show()
```

### –ü–æ–¥—Ä–æ–±–Ω—ã–µ –≤—ã–≤–æ–¥—ã –∏ –∞–Ω–∞–ª–∏–∑

```markdown
## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**MongoDB –ø–æ–∫–∞–∑–∞–ª–∞ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (–≤ 10.66 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ) –¥–ª—è –±–∞–∑–æ–≤—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:

1. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** - Aggregation Pipeline —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –ø–∞–º—è—Ç–∏
2. **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∞–≥—Ä–µ–≥–∞—Ü–∏–∏** - `$group`, `$max` –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏
3. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤** - B-–¥–µ—Ä–µ–≤—å—è –≤ MongoDB —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–π –ø–æ –ø–æ–ª—è–º
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–ª–æ–∂–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤

**PostgreSQL —É—Å—Ç—É–ø–∏–ª –≤ –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö** –∏–∑-–∑–∞:
- –ù–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥ SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–µ–Ω–µ–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è–º–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**PostgreSQL –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** (–≤ 2.70 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ) –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

1. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SQL –¥–≤–∏–∂–æ–∫** - —Å–ª–æ–∂–Ω—ã–µ CTE (Common Table Expressions) –∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã
2. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ JOIN –æ–ø–µ—Ä–∞—Ü–∏–∏** - —Ö—ç—à-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞** - –±–æ–≥–∞—Ç–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
4. **–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞–Ω–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤

**MongoDB —É—Å—Ç—É–ø–∏–ª–∞ –≤ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö** –∏–∑-–∑–∞:
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ö–æ–¥–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º –≤ Aggregation Pipeline
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ù–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É BSON –∏ JavaScript

### –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π

#### PostgreSQL –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è IoT:
- **–°—Ç—Ä–æ–≥–∞—è —Å—Ö–µ–º–∞** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö IoT –¥–∞–Ω–Ω—ã—Ö
- **–ë–æ–≥–∞—Ç—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - —Å–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö, TOAST –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

#### MongoDB –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è IoT:
- **–ì–∏–±–∫–∞—è —Å—Ö–µ–º–∞** –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è —Å–µ–Ω—Å–æ—Ä–æ–≤
- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - —à–∞—Ä–¥–∏–Ω–≥ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π
- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è** - –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –°–£–ë–î

#### –í—ã–±–∏—Ä–∞—Ç—å PostgreSQL –¥–ª—è IoT –∫–æ–≥–¥–∞:
1. **–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–ª–æ–∂–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
2. **–ö—Ä–∏—Ç–∏—á–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ IoT, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
3. **–ù–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–æ–∂–Ω—ã–µ JOIN** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–µ–Ω—Å–æ—Ä–æ–≤
4. **–¢—Ä–µ–±—É–µ—Ç—Å—è SQL-—Å—Ç–∞–Ω–¥–∞—Ä—Ç** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ BI-—Å–∏—Å—Ç–µ–º–∞–º–∏

#### –í—ã–±–∏—Ä–∞—Ç—å MongoDB –¥–ª—è IoT –∫–æ–≥–¥–∞:
1. **–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω—á–∏–≤–∞** - —á–∞—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Å–µ–Ω—Å–æ—Ä–æ–≤
2. **–¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–µ–Ω—Å–æ—Ä–Ω—ã–µ —Å–µ—Ç–∏
3. **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å—å** - —Ç—ã—Å—è—á–∏ —Å–µ–Ω—Å–æ—Ä–æ–≤ –ø–∏—à—É—Ç –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
4. **–ì–µ–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Å–µ–Ω—Å–æ—Ä—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

#### –î–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ IoT:
- **PostgreSQL** –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ª–æ–∂–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- **MongoDB** –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤

#### –î–ª—è —É–º–Ω–æ–≥–æ –¥–æ–º–∞:
- **MongoDB** –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Å—Ç–æ—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **PostgreSQL** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
- **MongoDB** –Ω–∞ edge-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–µ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (–Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–∞)
- –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö IoT –Ω–∞–≥—Ä—É–∑–æ–∫)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

#### –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã —Ä–∞–∑–≤–∏—Ç–∏—è:
- **Time-Series –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (InfluxDB, TimescaleDB) –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IoT —Ä–µ—à–µ–Ω–∏–π
- **–ì–∏–±—Ä–∏–¥–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –æ–±–µ–∏—Ö –°–£–ë–î
- **Edge computing** - –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–ª–∏–∂–µ –∫ —Å–µ–Ω—Å–æ—Ä–∞–º

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ, —á—Ç–æ –≤—ã–±–æ—Ä –º–µ–∂–¥—É PostgreSQL –∏ MongoDB –¥–ª—è IoT —Å–∏—Å—Ç–µ–º –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞. 

**MongoDB –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∏—Å—Ç–µ–º —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –∑–∞–ø–∏—Å—å –∏ –∏–∑–º–µ–Ω—á–∏–≤–æ–π —Å—Ö–µ–º–æ–π –¥–∞–Ω–Ω—ã—Ö.

**PostgreSQL –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ** –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å–∏—Å—Ç–µ–º, —Ç—Ä–µ–±—É—é—â–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π ACID –∏ —Å–ª–æ–∂–Ω—ã—Ö —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å **–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥**, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π MongoDB –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ PostgreSQL –¥–ª—è –≥–ª—É–±–∏–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ–±–µ–∏—Ö —Å–∏—Å—Ç–µ–º.
```
